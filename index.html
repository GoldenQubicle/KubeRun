<!DOCTYPE html>
<html lang="en">
  <head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="stuff made by me!">
    <meta name="author" content="vrtxt">
    <link rel="icon" href="../../favicon.ico">
    <title>GQ ~ KubeRun</title>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"

      integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"

      crossorigin="anonymous">
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"

integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"

crossorigin="anonymous"></script>
    <!-- Bootstrap core CSS -->
    <!--  <link href="../../dist/css/bootstrap.min.css" rel="stylesheet">-->
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <!-- <link href="../../assets/css/ie10-viewport-bug-workaround.css" rel="stylesheet">-->
    <!-- Custom styles for this template -->
    <!--  <link href="cover.css" rel="stylesheet"> -->
    <link rel="stylesheet" href="https://dl.dropbox.com/s/w3z7bkdgperb50p/cover.css?dl=0">
    <!--  <script src="../../assets/js/ie-emulation-modes-warning.js"></script>-->
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>    <![endif]-->
    <script language="javascript" type="text/javascript" src="processing.min.js"></script>
  </head>
  <body> 
  <br>
  <br>
      Use mouse to dodge Kubes. 
      If you hit a Kube the 'game' will pause, and somehow become kinda unresponsive . ?
      sorry 'bout that ¯\_(ツ)_/¯
      <br><br>
     <script type="text/processing" data-processing-target="processing-canvas">
import processing.opengl.*
float Speed, fov, drawdistance, Zplane;
ArrayList <Cubes> Kubes;
boolean hit = false;

void setup() {
 
  size(640, 640, OPENGL); // using opengl for web

  Speed = 10; // obviously wanna make this dynamic later
  
  Zplane =  ((height/2.0) / tan(PI*60.0/360.0)); // default cameraZ from perspective(); 
  fov = PI/3.0;
  drawdistance = 2000;
  perspective(fov, float(width)/float(height), 1, drawdistance); // however still need custom perpective to set zNear at 1
  
  Kubes = new ArrayList();
}

void draw() {
  //cam.feed();
  background (127);  

  //generate cubes & add to ArrayList 
  if (hit == false) {
    Cubes myKube = new Cubes(); 
    Kubes.add(myKube);
  }

  // iterate backwards over Arraylist & delete cubes once out of sight
  for (int i = Kubes.size()-1; i >= 0; i--) {   
    Cubes myCube = Kubes.get(i);
    pushMatrix();
    translate(mouseX-width/2, mouseY-height/2, 0);  //mouse movement
    myCube.display();
    myCube.move();
    myCube.collision();
    if (myCube.OutOfSight()) {
      Kubes.remove(i);
    }  
    popMatrix();
    //println(Kubes.size(), myCube.pos.z, Zplane);
    //println(mouseX,mouseY);
  }
}

void keyPressed() {
  // reset
  if (key == 'r') {
    hit = false;
    Speed = 10;
  }
}

class Cubes {

  PShape Kube;
  PVector size, pos, cubeW, cubeH;
  float cubeR, cubeG, cubeB; // r,g,b color values
  boolean Z = false;

  Cubes() {
    // procedural spawn
    pos = new PVector(random(0, 640), random(0, 640), random(0, 10)); // make z plane in which to spawn dynamic 
    size = new PVector(random(10, 50), random(10, 50), random(10, 50)); // prolly want to make the size constraints dynamic, too

    // static spawn for collision detection & debugging
    //pos = new PVector(317, 537, 300);
    //size = new PVector(10, 10, 10);

    // normalise position & volume of cube for collision
    cubeW = new PVector(norm(pos.x-(size.x), 0, 640), norm(pos.x+(size.x), 0, 640));
    cubeH = new PVector(norm(pos.y-(size.y), 0, 640), norm(pos.y+(size.y), 0, 640));

    // random color 
    cubeR = int(random(0, 255));
    cubeG = int(random(0, 255));
    cubeB = int(random(0, 255));
    color c = color(cubeR, cubeG, cubeG); /* initially used cubeG twice by accident but 
     put it back on purpose bc I liked the result =) */

   // Kube = createShape(BOX, size.x, size.y, size.z);
   // Kube.setFill(c);
  }

  void move() {
    pos.z += Speed;
    
    if (hit == true) {
      Speed = 0;
      println("HIT");
    }
  }

  void display() {
    pushMatrix();
    translate(pos.x, pos.y, pos.z); 
    //shape(Kube);
    fill(cubeR,cubeG,cubeG);
    box(size.x, size.y, size.z);
    popMatrix();
  }

  boolean OutOfSight() {
    // check if Kube is behind Zplane
    if (pos.z-size.z > Zplane) {
      Z = true;
    }
    return Z;
  }


  void collision() {
    //normalse mouse position
    float mX = 1-norm(mouseX, 0, 640);
    float mY = 1-norm(mouseY, 0, 640);
    
    // check if cube is on Zplane
    if ((pos.z+size.z > Zplane)) {   
      // check normalized mouse position against normalized kube position
      if ( (mX > cubeW.x) && (mX < cubeW.y) && (mY > cubeH.x) && (mY < cubeH.y) ) {
        hit = true;
      }
    }
  }
}

</script>
<canvas id="processing-canvas"> </canvas>

    <br>
    Needless to say still very much work in progress, hope you enjoyed it nonetheless. =)<br>
  </body>
</html>
